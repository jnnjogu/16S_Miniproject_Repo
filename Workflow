# Data Download
wget https://zenodo.org/record/4559793/files/honey_bees_samples.zip?download=1
gunzip evz166_supplementary_data(1).zip

# Quality Check of the reads (Fastqc) 

{

module load fastqc
fastqc *.gz
module load multiqc
multiqc *.html

}

# trimming of the reads  using trimmomatic

{

"""
module load Trimmomatic
for read in *_R1_001.fastq.gz;
do
        read=$(basename ${read} _R1_001.fastq.gz)
        trimmomatic PE -phred33 ${read}_R1_001.fastq.gz ${read}_R2_001.fastq.gz\
        ${read}_paired_R1.fastq.gz ${read}_unpaired_R1.fastq.gz\
        ${read}_paired_R2.fastq.gz ${read}_unpaired_R2.fastq.gz\
        ILLUMINACLIP:/opt/apps/trimmomatic/0.39/adapters/TruSeq3-PE.fa:2:30:10\
        LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
done
"""
}

# merge the paired reads

{
module load usearch
usearch -fastq_mergepairs *_R1.fastq -reverse *_R2.fastq mergedreads.fastq -relable @ #merge the forward and reverse reads
usearch -fastx_subsample mergedreads -samplesize 10000 -fastqout subsample.fastq #making a subsample of the total reads
nano primer.fa #copied the primers to the primer.fa file
usearch -search_oligodb subsample.fastq -db primer.fa -strand both -userout hits.txt -userfields query+target+qstrand+diffs+tlo+thi+trowdots \
# Primer search within the reads
usearch -fastq_filter mergedreads.fastq --fastq_stripleft 19 --fastq_stripright 20 -fastaout filtered_reads.fasta # Filtered the reads to remove the primers
usearch -search_oligodb filtered_reads.fasta -db primer.fa -strand both -userout filttered-primerhits.txt -userfields query+target+qstrand+diffs+tlo+thi+trowdots \
# Did another search to confirm the removal of the primers we got .1%
}

